# é‚®ä»¶é€šçŸ¥åŠŸèƒ½ä½¿ç”¨æŒ‡å—

## ğŸ“§ åŠŸèƒ½æ¦‚è¿°

GAC ç§¯åˆ†é‡ç½®å·¥å…·ç°å·²æ”¯æŒé‚®ä»¶é€šçŸ¥åŠŸèƒ½ï¼Œå¯åœ¨é‡è¦äº‹ä»¶å‘ç”Ÿæ—¶è‡ªåŠ¨å‘é€é‚®ä»¶æé†’ã€‚

---

## âœ¨ æ”¯æŒçš„é€šçŸ¥åœºæ™¯

| åœºæ™¯           | è¯´æ˜                      | é»˜è®¤çŠ¶æ€ |
| -------------- | ------------------------- | -------- |
| **é‡ç½®æˆåŠŸ**   | ç§¯åˆ†é‡ç½®æˆåŠŸæ—¶å‘é€        | å…³é—­     |
| **é‡ç½®å¤±è´¥**   | é‡ç½®å¤±è´¥æˆ–å‡ºé”™æ—¶å‘é€      | å¼€å¯     |
| **Token åˆ·æ–°** | è®¤è¯ token è‡ªåŠ¨åˆ·æ–°æ—¶å‘é€ | å¼€å¯     |
| **è®¢é˜…å¤±è´¥**   | è®¢é˜…æ£€æŸ¥å¤±è´¥æ—¶å‘é€        | å¼€å¯     |
| **ç½‘ç»œé”™è¯¯**   | ç½‘ç»œè¿æ¥å¼‚å¸¸æ—¶å‘é€        | å¼€å¯     |

---

## ğŸ”§ é…ç½®é‚®ä»¶é€šçŸ¥

### 1. ç¼–è¾‘é…ç½®æ–‡ä»¶

åœ¨ `config.json` ä¸­æ·»åŠ  `email_alerts` é…ç½®ï¼š

```json
{
  "auth_token": "",
  "email": "your_email@example.com",
  "password": "your_password",
  "base_url": "https://gaccode.com/api",
  "email_alerts": {
    "enabled": true,
    "smtp_server": "smtp.gmail.com",
    "smtp_port": 587,
    "smtp_user": "your_email@gmail.com",
    "smtp_password": "your_app_password",
    "from_email": "your_email@gmail.com",
    "to_email": "your_notification_email@example.com",
    "on_failure": true,
    "on_success": false,
    "on_token_refresh": true
  }
}
```

### 2. é…ç½®é¡¹è¯´æ˜

#### åŸºç¡€é…ç½®

| é…ç½®é¡¹          | ç±»å‹    | è¯´æ˜                       | å¿…å¡« |
| --------------- | ------- | -------------------------- | ---- |
| `enabled`       | boolean | æ˜¯å¦å¯ç”¨é‚®ä»¶é€šçŸ¥           | æ˜¯   |
| `smtp_server`   | string  | SMTP æœåŠ¡å™¨åœ°å€            | æ˜¯   |
| `smtp_port`     | number  | SMTP ç«¯å£å·                | æ˜¯   |
| `smtp_user`     | string  | SMTP ç™»å½•ç”¨æˆ·å            | æ˜¯   |
| `smtp_password` | string  | SMTP ç™»å½•å¯†ç /åº”ç”¨ä¸“ç”¨å¯†ç  | æ˜¯   |
| `from_email`    | string  | å‘ä»¶äººé‚®ç®±                 | æ˜¯   |
| `to_email`      | string  | æ”¶ä»¶äººé‚®ç®±                 | æ˜¯   |

#### é€šçŸ¥å¼€å…³

| é…ç½®é¡¹             | ç±»å‹    | è¯´æ˜                 | é»˜è®¤å€¼ |
| ------------------ | ------- | -------------------- | ------ |
| `on_failure`       | boolean | å¤±è´¥æ—¶å‘é€é‚®ä»¶       | true   |
| `on_success`       | boolean | æˆåŠŸæ—¶å‘é€é‚®ä»¶       | false  |
| `on_token_refresh` | boolean | Token åˆ·æ–°æ—¶å‘é€é‚®ä»¶ | true   |

---

## ğŸ“® å¸¸è§é‚®ä»¶æœåŠ¡å•†é…ç½®

### Gmail

```json
{
  "smtp_server": "smtp.gmail.com",
  "smtp_port": 587,
  "smtp_user": "your_email@gmail.com",
  "smtp_password": "your_16_digit_app_password"
}
```

**æ³¨æ„ï¼š** Gmail éœ€è¦ä½¿ç”¨åº”ç”¨ä¸“ç”¨å¯†ç ï¼Œä¸èƒ½ä½¿ç”¨è´¦å·å¯†ç ã€‚

**è·å–åº”ç”¨ä¸“ç”¨å¯†ç ï¼š**

1. è®¿é—® https://myaccount.google.com/security
2. å¯ç”¨ä¸¤æ­¥éªŒè¯
3. ç”Ÿæˆåº”ç”¨ä¸“ç”¨å¯†ç 

### 163 é‚®ç®±

```json
{
  "smtp_server": "smtp.163.com",
  "smtp_port": 465,
  "smtp_user": "your_email@163.com",
  "smtp_password": "your_authorization_code"
}
```

**æ³¨æ„ï¼š** 163 é‚®ç®±éœ€è¦ä½¿ç”¨æˆæƒç ï¼Œä¸æ˜¯ç™»å½•å¯†ç ã€‚

**è·å–æˆæƒç ï¼š**

1. ç™»å½• 163 é‚®ç®±
2. è®¾ç½® â†’ POP3/SMTP/IMAP
3. å¼€å¯ SMTP æœåŠ¡
4. è·å–æˆæƒç 

### QQ é‚®ç®±

```json
{
  "smtp_server": "smtp.qq.com",
  "smtp_port": 465,
  "smtp_user": "your_email@qq.com",
  "smtp_password": "your_authorization_code"
}
```

**è·å–æˆæƒç ï¼š**

1. ç™»å½• QQ é‚®ç®±
2. è®¾ç½® â†’ è´¦æˆ·
3. å¼€å¯ SMTP æœåŠ¡
4. ç”Ÿæˆæˆæƒç 

### Outlook/Hotmail

```json
{
  "smtp_server": "smtp-mail.outlook.com",
  "smtp_port": 587,
  "smtp_user": "your_email@outlook.com",
  "smtp_password": "your_account_password"
}
```

---

## ğŸ§ª æµ‹è¯•é‚®ä»¶åŠŸèƒ½

### æ–¹æ³• 1: ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°

```bash
python auto_reset_credits_advanced.py --test-email
```

### æ–¹æ³• 2: æµ‹è¯•è¾“å‡ºç¤ºä¾‹

```
============================================================
Email Notification Test Mode
============================================================
Config: config.json
------------------------------------------------------------
[INFO] Credit balance:
  - Balance: 100
[INFO] Sending email: é‚®ä»¶åŠŸèƒ½æµ‹è¯•
[SUCCESS] Email sent successfully: é‚®ä»¶åŠŸèƒ½æµ‹è¯•
------------------------------------------------------------
Test complete. Please check your inbox.
============================================================
```

### æµ‹è¯•é‚®ä»¶å†…å®¹

```
GACç§¯åˆ†é‡ç½®å·¥å…·é€šçŸ¥

æ—¶é—´: 2025-11-12 15:30:45
ç±»å‹: info

è¿™æ˜¯ä¸€å°æµ‹è¯•é‚®ä»¶ï¼Œç”¨äºéªŒè¯GACç§¯åˆ†é‡ç½®å·¥å…·çš„é‚®ä»¶åŠŸèƒ½ã€‚

å¦‚æœæ‚¨æ”¶åˆ°æ­¤é‚®ä»¶ï¼Œè¯´æ˜é‚®ä»¶é…ç½®æ­£ç¡®ã€‚
å½“å‰ç§¯åˆ†: 100

é…ç½®æ–‡ä»¶: config.json
æµ‹è¯•æ—¶é—´: 2025-11-12 15:30:45

æ‚¨å¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´ config.json ä¸­çš„é‚®ä»¶é€šçŸ¥è®¾ç½®ã€‚

---
æ­¤é‚®ä»¶ç”±GACç§¯åˆ†é‡ç½®å·¥å…·è‡ªåŠ¨å‘é€
é…ç½®æ–‡ä»¶: config.json
```

---

## ğŸ“¨ é‚®ä»¶é€šçŸ¥ç¤ºä¾‹

### æˆåŠŸé€šçŸ¥

**ä¸»é¢˜ï¼š** `[GACç§¯åˆ†é‡ç½®å·¥å…·] ç§¯åˆ†é‡ç½®æˆåŠŸ âœ…`

**å†…å®¹ï¼š**

```
GACç§¯åˆ†é‡ç½®å·¥å…·é€šçŸ¥

æ—¶é—´: 2025-11-12 15:30:45
ç±»å‹: success

ç§¯åˆ†å·²æˆåŠŸé‡ç½®ï¼

å·¥å•ID: 902875
å“åº”æ¶ˆæ¯: ğŸ‰ æ­å–œï¼æ‚¨çš„ç§¯åˆ†å……å€¼ç”³è¯·å·²è‡ªåŠ¨æ‰¹å‡†ã€‚æ‚¨çš„ç§¯åˆ†å·²é‡ç½®ï¼âœ…
å®Œæˆæ—¶é—´: 2025-11-12 15:30:45
å½“å‰ç§¯åˆ†: 100

---
æ­¤é‚®ä»¶ç”±GACç§¯åˆ†é‡ç½®å·¥å…·è‡ªåŠ¨å‘é€
é…ç½®æ–‡ä»¶: config.json
```

### å¤±è´¥é€šçŸ¥

**ä¸»é¢˜ï¼š** `[GACç§¯åˆ†é‡ç½®å·¥å…·] ç½‘ç»œé”™è¯¯ - æ— æ³•éªŒè¯é‡ç½®çŠ¶æ€`

**å†…å®¹ï¼š**

```
GACç§¯åˆ†é‡ç½®å·¥å…·é€šçŸ¥

æ—¶é—´: 2025-11-12 15:30:45
ç±»å‹: error

æ— æ³•éªŒè¯ä»Šå¤©æ˜¯å¦å·²ç»é‡ç½®ç§¯åˆ†ï¼ˆç½‘ç»œè¿æ¥å¤±è´¥ï¼‰ã€‚
ä¸ºé¿å…é‡å¤æäº¤ï¼Œå·²ç»ˆæ­¢æ‰§è¡Œã€‚
è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥åé‡è¯•ã€‚

---
æ­¤é‚®ä»¶ç”±GACç§¯åˆ†é‡ç½®å·¥å…·è‡ªåŠ¨å‘é€
é…ç½®æ–‡ä»¶: config.json
```

### Token åˆ·æ–°é€šçŸ¥

**ä¸»é¢˜ï¼š** `[GACç§¯åˆ†é‡ç½®å·¥å…·] è®¤è¯Tokenå·²åˆ·æ–°`

**å†…å®¹ï¼š**

```
GACç§¯åˆ†é‡ç½®å·¥å…·é€šçŸ¥

æ—¶é—´: 2025-11-12 15:30:45
ç±»å‹: token_refresh

ç™»å½•æˆåŠŸï¼Œå·²è‡ªåŠ¨æ›´æ–°è®¤è¯tokenã€‚
ç™»å½•æ—¶é—´: 2025-11-12 15:30:45
Token (å‰50å­—ç¬¦): ayJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQi...

---
æ­¤é‚®ä»¶ç”±GACç§¯åˆ†é‡ç½®å·¥å…·è‡ªåŠ¨å‘é€
é…ç½®æ–‡ä»¶: config.json
```

---

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### åœºæ™¯ 1: æ¯æ—¥è‡ªåŠ¨è¿è¡Œï¼ˆæ¨èï¼‰

**é…ç½®ï¼š**

```json
{
  "email_alerts": {
    "enabled": true,
    "on_failure": true,
    "on_success": false,
    "on_token_refresh": true
  }
}
```

**è¯´æ˜ï¼š**

- åªåœ¨å¤±è´¥æˆ– Token åˆ·æ–°æ—¶å‘é€é‚®ä»¶
- æˆåŠŸæ—¶ä¸å‘é€ï¼Œå‡å°‘é‚®ä»¶æ•°é‡
- é€‚åˆå®šæ—¶ä»»åŠ¡ä½¿ç”¨

### åœºæ™¯ 2: é¦–æ¬¡æµ‹è¯•

**é…ç½®ï¼š**

```json
{
  "email_alerts": {
    "enabled": true,
    "on_failure": true,
    "on_success": true,
    "on_token_refresh": true
  }
}
```

**è¯´æ˜ï¼š**

- æ‰€æœ‰äº‹ä»¶éƒ½å‘é€é‚®ä»¶
- æ–¹ä¾¿éªŒè¯é‚®ä»¶åŠŸèƒ½
- æµ‹è¯•å®Œæˆåå»ºè®®å…³é—­æˆåŠŸé€šçŸ¥

### åœºæ™¯ 3: ä»…å¼‚å¸¸é€šçŸ¥

**é…ç½®ï¼š**

```json
{
  "email_alerts": {
    "enabled": true,
    "on_failure": true,
    "on_success": false,
    "on_token_refresh": false
  }
}
```

**è¯´æ˜ï¼š**

- åªåœ¨å‡ºç°é”™è¯¯æ—¶å‘é€
- æœ€å°åŒ–é‚®ä»¶å¹²æ‰°
- é€‚åˆç¨³å®šè¿è¡Œç¯å¢ƒ

---

## â“ æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: é‚®ä»¶å‘é€å¤±è´¥

**ç—‡çŠ¶ï¼š**

```
[ERROR] Failed to send email: SMTPAuthenticationError
```

**è§£å†³æ–¹æ¡ˆï¼š**

1. æ£€æŸ¥ SMTP ç”¨æˆ·åå’Œå¯†ç æ˜¯å¦æ­£ç¡®
2. ç¡®è®¤ä½¿ç”¨çš„æ˜¯åº”ç”¨ä¸“ç”¨å¯†ç ï¼ˆè€Œéè´¦å·å¯†ç ï¼‰
3. æ£€æŸ¥é‚®ç®±æ˜¯å¦å¼€å¯äº† SMTP æœåŠ¡

### é—®é¢˜ 2: è¿æ¥è¶…æ—¶

**ç—‡çŠ¶ï¼š**

```
[ERROR] Failed to send email: TimeoutError
```

**è§£å†³æ–¹æ¡ˆï¼š**

1. æ£€æŸ¥ SMTP æœåŠ¡å™¨åœ°å€æ˜¯å¦æ­£ç¡®
2. ç¡®è®¤ç«¯å£å·æ­£ç¡®ï¼ˆ587 for STARTTLS, 465 for SSLï¼‰
3. æ£€æŸ¥é˜²ç«å¢™è®¾ç½®

### é—®é¢˜ 3: SSL/TLS é”™è¯¯

**ç—‡çŠ¶ï¼š**

```
[ERROR] Failed to send email: SSLError
```

**è§£å†³æ–¹æ¡ˆï¼š**

1. 587 ç«¯å£ä½¿ç”¨ STARTTLSï¼ˆè‡ªåŠ¨å¤„ç†ï¼‰
2. 465 ç«¯å£ä½¿ç”¨ SSLï¼ˆè‡ªåŠ¨å¤„ç†ï¼‰
3. ç¡®è®¤é‚®ä»¶æœåŠ¡å•†æ”¯æŒçš„è¿æ¥æ–¹å¼

### é—®é¢˜ 4: é…ç½®ä¸å®Œæ•´

**ç—‡çŠ¶ï¼š**

```
[WARNING] Email configuration incomplete, missing: ['smtp_password']
```

**è§£å†³æ–¹æ¡ˆï¼š**

1. æ£€æŸ¥ config.json ä¸­çš„ email_alerts é…ç½®
2. ç¡®ä¿æ‰€æœ‰å¿…å¡«å­—æ®µéƒ½å·²å¡«å†™
3. å‚è€ƒæœ¬æ–‡æ¡£çš„é…ç½®ç¤ºä¾‹

---

## ğŸ”’ å®‰å…¨å»ºè®®

### 1. ä¿æŠ¤é…ç½®æ–‡ä»¶

```bash
# Linux/macOS
chmod 600 config.json
```

### 2. ä½¿ç”¨åº”ç”¨ä¸“ç”¨å¯†ç 

- âœ… ä½¿ç”¨åº”ç”¨ä¸“ç”¨å¯†ç /æˆæƒç 
- âŒ ä¸è¦ä½¿ç”¨è´¦å·å¯†ç 
- âœ… å®šæœŸæ›´æ¢å¯†ç 

### 3. é™åˆ¶é‚®ä»¶å†…å®¹

- é‚®ä»¶ä¸­ä¸åŒ…å«å®Œæ•´ token
- ä»…æ˜¾ç¤ºå‰ 50 ä¸ªå­—ç¬¦
- æ•æ„Ÿä¿¡æ¯è‡ªåŠ¨éšè—

### 4. é…ç½®æ–‡ä»¶ç®¡ç†

```bash
# æ·»åŠ åˆ°.gitignore
echo "config.json" >> .gitignore

# ä¸è¦æäº¤åŒ…å«å¯†ç çš„é…ç½®æ–‡ä»¶
```

---

## ğŸ“Š SMTP ç«¯å£è¯´æ˜

| ç«¯å£ | åè®®     | è¯´æ˜                      | æ¨è |
| ---- | -------- | ------------------------- | ---- |
| 25   | SMTP     | æ ‡å‡†ç«¯å£ï¼Œå¯èƒ½è¢« ISP å°ç¦ | âŒ   |
| 587  | STARTTLS | æ¨èç”¨äºå®¢æˆ·ç«¯æäº¤        | âœ…   |
| 465  | SSL/TLS  | å®‰å…¨è¿æ¥                  | âœ…   |

**è„šæœ¬è‡ªåŠ¨å¤„ç†ï¼š**

- 587 ç«¯å£ï¼šä½¿ç”¨ STARTTLS
- 465 ç«¯å£ï¼šä½¿ç”¨ SSL
- å…¶ä»–ç«¯å£ï¼šä½¿ç”¨ STARTTLS

---

## ğŸ”„ é…ç½®æ›´æ–°ç¤ºä¾‹

### ä»æ— é‚®ä»¶é€šçŸ¥å‡çº§

**æ—§é…ç½®ï¼ˆv1.2.1ï¼‰ï¼š**

```json
{
  "auth_token": "",
  "email": "user@example.com",
  "password": "password"
}
```

**æ–°é…ç½®ï¼ˆv1.2.2ï¼‰ï¼š**

```json
{
  "auth_token": "",
  "email": "user@example.com",
  "password": "password",
  "email_alerts": {
    "enabled": true,
    "smtp_server": "smtp.gmail.com",
    "smtp_port": 587,
    "smtp_user": "your_email@gmail.com",
    "smtp_password": "your_app_password",
    "from_email": "your_email@gmail.com",
    "to_email": "your_email@gmail.com",
    "on_failure": true,
    "on_success": false,
    "on_token_refresh": true
  }
}
```

---

## ğŸ“ æœ€ä½³å®è·µ

### 1. é‚®ä»¶é€šçŸ¥ç­–ç•¥

- âœ… å¤±è´¥é€šçŸ¥ï¼šå¿…é¡»å¼€å¯
- âš ï¸ æˆåŠŸé€šçŸ¥ï¼šæ ¹æ®éœ€è¦
- âœ… Token åˆ·æ–°ï¼šå»ºè®®å¼€å¯

### 2. æ”¶ä»¶é‚®ç®±

- ä½¿ç”¨ä¸“é—¨çš„é€šçŸ¥é‚®ç®±
- è®¾ç½®é‚®ä»¶è¿‡æ»¤è§„åˆ™
- é¿å…é‚®ä»¶è¿‡è½½

### 3. å®šæ—¶ä»»åŠ¡

```bash
# crontabç¤ºä¾‹ï¼ˆæ¯å¤©æ—©ä¸Š9ç‚¹ï¼‰
0 9 * * * cd /path/to/script && python3 auto_reset_credits_advanced.py >> /tmp/gac_reset.log 2>&1
```

### 4. æ—¥å¿—ç®¡ç†

- ä¿ç•™é‚®ä»¶å‘é€æ—¥å¿—
- å®šæœŸæ£€æŸ¥å‘é€çŠ¶æ€
- åŠæ—¶å¤„ç†å¤±è´¥é€šçŸ¥

---

## ğŸ“ é«˜çº§é…ç½®

### å¤šæ”¶ä»¶äººï¼ˆä¿®æ”¹é…ç½®ï¼‰

ç›®å‰æ”¯æŒå•ä¸ªæ”¶ä»¶äººï¼Œå¦‚éœ€å¤šä¸ªæ”¶ä»¶äººï¼Œå¯ä¿®æ”¹è„šæœ¬ï¼š

```python
# åœ¨ send_email_alert æ–¹æ³•ä¸­
to_emails = ['email1@example.com', 'email2@example.com']
msg['To'] = ', '.join(to_emails)
server.sendmail(from_email, to_emails, msg.as_string())
```

### HTML é‚®ä»¶ï¼ˆé«˜çº§ï¼‰

é»˜è®¤å‘é€çº¯æ–‡æœ¬é‚®ä»¶ã€‚å¦‚éœ€ HTML æ ¼å¼ï¼Œå¯ä¿®æ”¹ï¼š

```python
html_body = f"<html><body><h2>{subject}</h2><p>{body}</p></body></html>"
msg.attach(MIMEText(html_body, 'html', 'utf-8'))
```

---

## ğŸ“ è·å–å¸®åŠ©

### ç›¸å…³æ–‡æ¡£

- `AUTO_LOGIN_GUIDE.md` - è‡ªåŠ¨ç™»å½•æŒ‡å—
- `QUICKSTART.md` - å¿«é€Ÿå¼€å§‹
- `UPDATE_v1.2.1.md` - ç‰ˆæœ¬æ›´æ–°è¯´æ˜

### æµ‹è¯•å‘½ä»¤

```bash
# æµ‹è¯•é‚®ä»¶åŠŸèƒ½
python auto_reset_credits_advanced.py --test-email

# æŸ¥çœ‹å¸®åŠ©
python auto_reset_credits_advanced.py --help
```

---

**ç‰ˆæœ¬ï¼š** v1.2.2  
**æ›´æ–°æ—¥æœŸï¼š** 2025-11-12  
**çŠ¶æ€ï¼š** âœ… å·²æµ‹è¯•

---

**äº«å—é‚®ä»¶é€šçŸ¥å¸¦æ¥çš„ä¾¿åˆ©ï¼** ğŸ“§
